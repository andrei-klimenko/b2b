# DDoS protection 

В начале хотелось бы задать следующие вопросы: 
  - C какого количества трафика происходит denial of services?
  - Должен ли сервис выдерживать n количество запросов?
  - Какого вида атака была (просто переход по main.page  или же более умный траффик; с маленького количества адресов или с большого и т.д.)? 
  - Какие возможности по защите можно использовать?
  - Какие сервисы получают нагрузку (например, api которое открыто наружу)

В общем случае при неограниченных ресурсах можно предположить следующие средства: от самого дорогого и надежного к самописным и менее надежным:

  - Для aws есть WAF и Shield - ресурс для защиты от ддос атак. WAF позволяет гибко настроить нужные network policy а также управлять трафиком (блокировать/фильтровать). Вне aws - подобные решение типа qrator
  - Load balancing и application scaling - возможность динамически масштабировать приложение в зависимости от потребностей. 
  - Network policies (black lists, traffic restriction) - иметь возможность ограничивать трафик вне страны назначения, создавать private vpc для общение сервисов внутри контура, настроить acl для доступа к сервисам. Если вне managed k8s - можно ограничивать доступ к нодам через iptables. 
  - Rate limiting - ingress имеет опцию по ограничению запросов с одного ip адреса


Общие правила по защите инфраструктуры (от внутренних атак)
  - Разграничение доступа через IAM, Service Accounts (как в aws так и в k8s) так и в репозиториях
  - Настроенные network policies - sg, acl (которые ограничивают все, кроме необходимого)
  - Хранение секретов в зашифрованном виде, либо в secret manager
